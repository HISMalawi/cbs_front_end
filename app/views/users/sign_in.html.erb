<div class="panel-title-sign mt-xl text-right">
  <h2 class="title text-uppercase text-bold m-none"><i class="fa fa-user mr-xs"></i> Sign In</h2>
</div>
<div class="panel-body">
  <form id="sign_in">
    <div class="form-group mb-lg">
      <label>Username</label>
      <div class="input-group input-group-icon">
        <input id="username" type="text" class="form-control input-lg" />
        <span class="input-group-addon">
										<span class="icon icon-lg">
											<i class="fa fa-user"></i>
										</span>
									</span>
      </div>
    </div>

    <div class="form-group mb-lg">
      <div class="clearfix">
        <label class="pull-left">Password</label>
        <a href="/password_recovery" class="pull-right">Lost Password?</a>
      </div>
      <div class="input-group input-group-icon">
        <input id="password" type="password" class="form-control input-lg" />
        <span class="input-group-addon">
										<span class="icon icon-lg">
											<i class="fa fa-lock"></i>
										</span>
									</span>
      </div>
    </div>

    <div class="row">
      <div class="col-sm-8">
        <div class="checkbox-custom checkbox-default">
          <input id="RememberMe" name="rememberme" type="checkbox"/>
          <label for="RememberMe">Remember Me</label>
        </div>
      </div>
      <div class="col-sm-4 text-right">
        <button type="submit" class="btn btn-primary hidden-xs">Sign In</button>
        <button type="submit" class="btn btn-primary btn-block btn-lg visible-xs mt-lg">Sign In</button>
      </div>
    </div>

    <p class="text-center">Don't have an account yet? <a href="/sign_up">Sign Up!</a>

  </form>
</div>

<script>
    // process the form
    $('#sign_in').submit(function(event) {

        let formData = {
            'username' : $('#username').val(),
            'password' : $('#password').val()
        };

        $.ajax({
            type        : 'POST',
            url         : '/sign_in',
            headers : {
                'X-CSRF-Token': $('meta[name="csrf-token"]').attr('content')
            },
            data        : formData,
            dataType    : 'json',
            encode       : true
        })
        // using the done promise callback
            .done(function(data) {
                if (data.token.length > 0) {
                    // $('form').append('<div class="alert alert-danger">' + data.message + '</div>');
                    document.location = '/';
                }
                // here we will handle errors and validation messages
                // if ( ! data.success) {
                //
                //     // handle errors for name ---------------
                //     // if (data.errors.name) {
                //     //     $('#name-group').addClass('has-error'); // add the error class to show red input
                //     //     $('#name-group').append('<div class="help-block">' + data.errors.name + '</div>'); // add the actual error message under our input
                //     // }
                //     //
                //     // // handle errors for email ---------------
                //     // if (data.errors.email) {
                //     //     $('#email-group').addClass('has-error'); // add the error class to show red input
                //     //     $('#email-group').append('<div class="help-block">' + data.errors.email + '</div>'); // add the actual error message under our input
                //     // }
                //     //
                //     // // handle errors for superhero alias ---------------
                //     // if (data.errors.superheroAlias) {
                //     //     $('#superhero-group').addClass('has-error'); // add the error class to show red input
                //     //     $('#superhero-group').append('<div class="help-block">' + data.errors.superheroAlias + '</div>'); // add the actual error message under our input
                //     // }
                //
                // } else {

                    // ALL GOOD! just show the success message!
                    // $('form').append('<div class="alert alert-success">' + data.message + '</div>');
                // }
            })
            // using the fail promise callback
            .fail(function(data) {
                $('form').append('<div class="alert alert-danger">Incorrect username or password combination</div>');
                console.log(data);
            });

        event.preventDefault();
    });
</script>
